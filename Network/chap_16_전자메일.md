# ---- 전자메일 사용자환경 ----
### 전자메일 기능
- 메일편집
    - 메일생성, 회신, 제3자에게 전달
    - 메시지 내용, 주소, 작성일자, 참조 수신자 ...
- 메일내용 읽기
    - 본문읽기
    - 첨부파일읽기
- 수신메일 관리
    - 메일박스
    - 삭제, 저장
- 전달여부 통지
    - 송신자에게 수신여부 통보
    - 메일시스템의 하부기능에 의한 구현 ---> 메일오류 통지...
    - 메일 시스템 자체 기능에 의한 구현 ---> 옵션으로 수신여부 확인...
- 메일전달(relay)
    - 호스트 사이 전달 ---> TCP이용
---
- 메일 메시지
    - 기본적으로 ASCII코드 기반 텍스트만 전송
    - 멀티미디어 데이터 수용하기 위한 기능확장(MIME)
    - 구성
        - 헤더
        - 빈 줄 
        - 본문(마지막 줄은 마침표만)
- MIME(multipurpose internet mail extension)
    - 실행파일, 음성, 영상 등 멀티미디어 데이터 수용하기 위한 기능확장
    - 처리
        - 메일송신 전 ---> 비ASCII데이터를 ASCII로 변환
        - 메일수신 전 ---> ASCII데이터를 비ASCII로 변환
---
# ----전자메일 시스템----
- 구성
    - 사용자 환경 = 메일 응용프로그램인 사용자 에이전트(UA)
        - 사용자 에이전트
            - 메일송수신하는 용도
            - 사용자 작업환경 제공
            - 표준화된 형식X
            - 사용자 프로그램 입력 정보 ---> 표준화된 형식으로 정의
                - 송신자 메일주소
                - 수신자 메일주소
                - 참조자 메일주소
                - 메일 메시지헤더 ---> 메일제목...
                - 메일 메시지 본문 ---> 메일내용 
    - 네트워크 환경 = 메일 중개, 송수신하는 메일전송 에이전트(MTA)
        - 메일전송 에이전트
            - 받는 메일 서버 = POP(post office protocol) ---> 수신, 다운로드
                - POP
                    - 전자메일 서버에 보관된 메일을 개인용PC로 다운로드 하는 프로토콜
                    - 명령, 응답
                    - well-known포트 = TCP 110번
                    - 메일 다운로드 과정에서 사용자 인증허가가 반드시 필요
                        - 동작시나리오
                            - 사용자 인증
                                - USER(POP3서버에 등록된 메일 주소의 로그인 이름을 서버에 통지)
                                - PASS(로그인 이름과 함꼐 사용하는 암호 통지)
                            - 메일 다운로드
                                - STAT = n(배달된 메일) 반환
                                - LIST
                                - RETR
                                    - 메일 데이터 다운로드
                                    - 원본은 서버에 有
                                - DELE
                                - QUIT = 세션종료
            - 보내는 메일서버  = SMTP(simple mail transfer protocol) ---> 송신
                - SMTP
                    - 전자메일을 송수신하는 호스트 사이에 필요한 프로토콜
                    - well-known 포트 = TCP 25번
                    - 메일 송수신 과정에서 사용자 인증 허가 필요X
                    - 메일 보내는 과정
                        - SMTP 클라이언트, 서버 사이의 TCP연결 설정하는 단계
                        - SMTP서버에 메일을 보내는 데이터 전송단계
                        - 메일전송을 완료, TCP연결 종료하는 단계
                    - 하나이상의 SMTP서버에 메일전달
                        - 서버로 접근 가능성 확인
                        - 서버와의 연결 설정
                        - 메일전송
                    - 서버와의 직접연결이 불가능한 경우에도 동작 ---> 메시지 저장, 중개방식
                    - 응답 = 3자리코드 + 추가정보
                    - 연결설정
                        - well-known포트 = TCP 25번
                        - 서버응답
                            - 수신준비 OK = 220
                            - 준비 X = 421
                        - 클라이언트 = HELO(송신자 호스트이름 전송 ---> 서버에 자신이 누군지 알림)
                        - 서버응답 = 250
                    - 데이터전송
                        - 명령과 응답
                        - 메일주소 확인과정
                            - MAIL FROM
                            - RCPT TO
                        - 헤더정보 전송과정
                            - DATA
                            - FROM
                            - TO
                            - DATE
                        - 메시지전송과정
                            - 빈 줄
                            - 송신메시지
                            - 점
                        - 연결해제
                            - 명령, 응답
                                - 클라이언트 QUIT요청
                                - 서버 211 회신
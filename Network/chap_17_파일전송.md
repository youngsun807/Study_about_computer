# ---- 파일 전송을 위한 사용자환경 ----
# ---- FTP ----
- 사용자는 클라이언트 프로그램을 이용하여 FTP서버에 접속 ---> 파일 다운, 업로드
- 로그인
    - 서버에 등록된 계정, 암호 필요
- 익명 FTP
    - 공개 S/W 배포등을 위해 불특정 다수 사용자가 이용할 수 있도록 익명 접속 허용
    - 계정이름 = anonymous
    - 암호 = 관례상 접속한 사용자 전자우편 주소
- 응답
    - 3자리 응답코드 + 설명문
        - 첫번째 숫자 = 2 ---> 성공
        - 첫번째 숫자 = 5 ---> 실패
        - 그 외 = 연속동작 지원용도
            |응답코드|의미|
            |:--|:--|
            |125|데이터 채널 설정, 이어서 데이터 전송 시작예정|
            |200|명령처리 완료|
            |230|사용자 로그인처리|
            |250|요청한 파일동작 처리|
            |331|로그인 이름을 정상적으로 처리, 암호 처리해야함|
            |425|데이터 채널 연결이 이루어지지X|
            |425|연결취소|
            |450|파일관련 처리 완료X|
            |451|동작처리 완료X|
            |500|잘못된 명령|
            |501|명령 인수 잘못됨|
---
### 주요명령
>- UNIX환경에서 FTP클라이언트 프로그램 실행 후 기본 명령 사용
>- Windows환경에서는 GUI 환경 지원
- |명령어|의미|
    |:--|:------|
    |get | 원격시스템에서 파일수신|
    |put | 원격시스템으로 파일송신|
    |ls||
    |cd|
    |lcd | 로컬 시스템의 현재 작업중인 디렉토리 이동|
    |bin | 8비트 송수신기능 지정|
    |QUIT | FTP프로그램 종료|
    |USER <로그인 이름> | 로그인 이름 전송|
    |PASS <암호> | 암호전송|
    |CWD <디렉토리> | 서버 현재 디렉토리 변경|
    |CDUP | 서버 현재 디렉토리를 상위로 이동|
    |PWD | 서버 현재 디렉토리 조회|
    |MKD <디렉토리> | 서버에서 디렉토리 생성|
    |RMD <디렉토리> | 서버에서 디렉토리 삭제|
    |DELE <파일>|서버에서 파일삭제|
    |LIST <디렉토리>|서버의 디렉토리 목록 조회|
    |TYPE <유형>|전송데이터 유형지정 ---> A(ASCII), E(EBCDIC), I(IMAGE)...|
    |RNFR <원래이름>|파일이름 변경시 원래파일 이름|
    |RNTO <새로운이름>|파일이름 변경시 새로운 파일이름|
    |RETR <파일>|서버 현재 디렉토리에서 파일 복사해옴|
    |STOR <파일>|클라이언트 파일을 서버 현재 디렉토리로 복사|
---
### 구조
- ``2개 채널 사용``
    - 제어
        - FTP프로토콜 명령, 응답전송
    - 데이터
        - 복사할는 파일 내용 전송
- 구성요소
    - 사용자 인터페이스 모듈
        - 사용자 명령 해석 ---> 명령 송수신 모듈에 전달
    - 명령 송수신 모듈
        - 제어 채널 설정(클라이언트가 초기화)
        - 사용자 명령을 FTP명령으로 전환 ---> 제어채널로 전송
    - 파일 송수신 모듈
        - 파일 송수니 요구가 발생할 때마다 데이터 채널 설정(서버가 초기화)
        - 데이터 채널을 통해 파일복사, 파일목록 전송기능 수행
    - well-known 포트
        - 제어 채널 | TCP 21번
        - 데이터 채널 | TCP 20번
---
### FTP 파일송수신절차
1. 클라이언트에서 데이터 채널 생성
2. PORT 명령 = 생성한 포트 번호 전달
3. RETR/STOR = 파일송수신 명령 전달
4. 데이터 채널 연결
5. 데이터 전송
6. 데이터 채널종료
7. 서버에서 응답코드 전송
---
---
# ---- TFTP(trivial file transfer protocol) ----
- 임의 시스템이 원격시스템으로부터 부팅코드를 다운로드할 때 사용하는 프로토콜
- 자체적으로 하드디스크를 보유하지 못한 X-terminal과 같은 장치
- 기존 FTP
    - TCP/IP 전체 프로토콜 스택
    - 2개 채널(제어, 데이터)
    - 디렉토리/파일 관리
- FTP기능 대폭 축소하여 경량화
    - TCP ---> UDP사용 = UDP 69포트
    - 복잡한 디렉토리, 파일관리 기능 제거
    - 오직 하나의 파일 복사
- 메시지
    - RRQ
        - 읽기 요청
        - parameter = 파일이름, 모드(ASCII와 이진파일 구분)
    - WRQ
        - 쓰기요청
        - parameter = 파일이름, 모드
    - DATA
        - 클라이언트나 서버가 데이터 블록전송
    - ACK
        - 클라이언트나 서버가 data에 대한 긍정응답 전송
    - ERROR
        - 전송과정에서 오류 발생
- 세션 설정, 읽기
    - ``UDP에는 연결기능X ---> 각 데이터 블록을 독립적으로 전송``
    - RRQ 보내면 세션 설정
    - DATA 이용하여 데이터 전송 ---> 그대로 유지 ---> 어디까지 보냈는지 알기 위해 세션 유지 필요
    - 마지막 DATA는 512바이트보다 작은 데이터 블록 송신 ---> 세션 해제
    - 파일 전송 서버 = DATA/ 클라이언트 = ACK만 사용
- 데이터 쓰기
    - WRQ 보내면 세션 설정
    - 파일 전송 서버 = DATA/ 클라이언트 = ACK만 사용
- 데이터전송
    - 데이터 블록 전송을 하나씩 처리하는 흐름제어 방식
        - 데이터 도착순서 바뀔 수 없음
    - 데이터 분실 ---> 송신 측의 타이머 이용
    - ACK 분실 ---> 송신 측 타이머 이용 ---> ACK 보낸 후 주어진 시간 내에 다음 데이터가 도착해야 계속 진행
    - TFTP는 NAK 지원X
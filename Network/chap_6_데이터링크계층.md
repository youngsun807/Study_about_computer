# ---- 프로토콜의 기초 ----
- 연결구성
    - 점대점
    - 멀티드롭
        - 주소 개별 필요
### 프레임 종류
- 정보 프레임(I)
    - 상위 계층이 전송 요구한 데이터를 송신하는 용도
    - 순서번호, 송수신호스트 정보 등이 포함
- 긍정응답 프레임(ACK)
    - 전송데이터가 올바르게 도착했음을 회신하는 용도
    - 수신호스트가 송신 호스트에게 전송
- 부정응답 프레임(NAK)
    - 전송 데이터가 깨져서 도착했음을 회신하는 용도
    - 수신호스트가 송신호스트에게 전송
    - 송신호스트가 원래 데이터 재전송하여 오류 복구
- 긍정, 부정응답 프레임 ⊃ I프레임 순서번호
    - 제대로 도착, 오류발생 판단 가능
---
### 오류, 흐름 제어 없는 프로토콜
- 가정
    - 단방향 통신
        - 송신 호스트 to 수신 호스트 한방향으로만 데이터 전송
    - 전송 오류 없는 물리매체
    - 무한 수신버퍼
        - 흐름 제어 기능 필요X
- 단순 프로토콜
    - 송신호스트는 원하는만큼 프레임 전송가능
    - 오류제어X
        - 프레임 분실, 변형오류 발생X
    - 흐름제어X
        - 수신버퍼 무한 --> 분실오류X
    - 순서번호 필요X
---
### 오류 제어 없는 프로토콜
- 가정
    - 단방향통신
    - 전송오류 없는 물리매체
    - 유한버퍼
        - 버퍼 부족 ---> 프레임 분실 가능
- 정지/대기 프로토콜
    - 수신버퍼 유한 ---> 흐름제어 필요
    - ACK 프레임 필요
        - 이전 프레임을 잘 받았다는 긍정응답
        - 수신호스트가 송신호스트의 전송시점을 지정
    - 순서번호 필요
    - 정지대기
        - 하나의 프레임 전송후 응답대기
        - 전송 효율 낮음 ---> 거의 사용X
---
### 단방향 프로토콜
- 가정
    - 단뱡향 통신
    - 전송 매체 오류 발생가능
        - 오류 제어, 흐름제어 필요
        - 프레임 변형 ---> 수신호스트 NAK 기능 필요
        - 프레임 분실 ---> 송신호스트 타임아웃 필요
    - 버퍼 유한
- NAK 없는 경우
    - 정보 프레임 분실 ---> 송신호스트 타임아웃으로 오류 복구
    - ACK 프레임 분실 ---> 송신호스트 타임아웃으로 오류 복구
- NAK 있는 경우
    - 정보 프레임 변형
        - 변형 프레임 무시
            - 프레임 분실 오류와 동일 처리
    - NAK 이용하여 통보
        - 더 효율적
        - 다른 요인에 의해 사용 못하는 경우도 있음
---
---
# ---- 슬라이딩 윈도우 프로토콜 ----
> 두 호스트간 데이터 전송을 위한 일반적인 통신 프로토콜
- 오류, 흐름 제어 지원
- 기본 절차
    1. 송신호스트는 정보프레임(전송데이터+순서번호+오류검출코드)를 순서번호에 따라 전송
    2. 수신호스트가 응답하는 순서번호 = 
        - 다음에 올 데이터 번호
        - 정상적 수신번호
    3. 송신윈도우(송신호스트가 관리) = 전송완료, 긍정응답 회신X 프레임 보관
    4. 수신윈도우(수신호스트가 관리) = 동작방식에 따라 크기가 다름
        - 선택적 재전송
            - 송신윈도우 크기 = 수신윈도우
            - 회신안된 것만 송신
            - 오류 생긴것만 버림
            - 정상적인 것은 버퍼에 담아둠
        - go-back N 
            - 송신윈도우 크기 = 1
            - 회신안된 데이터부터 그 뒤까지 다시 송신
            - 이후 정상적으로 송신된 것도 같이 다시 송신 ---> 버퍼에서 버림
- 순서번호
    - 프레임별로 부여되는 일련번호
    - 0부터 임의의 최대값까지 순환 방식으로 사용
    - max(순서번호) > 송신윈도우 크기
    - 순서번호 공간크기 = n비트, 2^n-1까지 
    - stop-and-wait = 1비트
- 윈도우크기
    - MAX(n(긍정응답 프레임 없이 연속으로 전송가능한 프레임))
---
### 연속형 전송
- 정지 대기 프로토콜 = (송신윈도우 크기 = 1)
    - 프레임 전송 시간 오래 걸릴 경우 전송 효율이 극단적으로 떨어짐
- 연속형 전송
    - ACK 프레임 받지않고 여러 프레임 연속으로 전송
    - 전송 오류 발새 가능성 적은 환경에서 효율적
    - 오류 발생 가능 ---> 해결 방안 필요
        - go-back N
        - 선택적 재전송
- 피기배킹
    - 양방향전송
        - 양방향으로 동시에 정보, 응답 프레임 교차하여 전송
        - 프레임 구조 = 정보 프레임 전송 + 응답기능 동시수행
        - 응답 프레임 전송 시 전송할 정보 프레임X
            - 응답프레임만 전송
            - 응답 늦춘후 피기배킹방식으로 전송
                - 얼마동안 늦출것인가?
---
---
# ---- HDLC프로토콜 ----
- 1:1, 1:N 환경에서 데이터 송수신 기능 제공
- 호스트 종류
    - 주국
        - 명령 전송 호스트
    - 종국
        - 명령 응답 회신 호스트
    - 혼합국
         주국, 종국 기능을 모두 가진 호스트
- 기본 동작 원리
    - 주국이 종국에게 명령 전송
    - 종국은 주국에게 응답 회신
- 프레임 구조
    - 비트 프레임
        - 플래그 사용
        - 프레임 시작, 끝
    - 주소
        - 1:N 환경 지원
        - 1:1 환경에서 명령과 응답 구분
    - 데이터
        - 가변 크기 전송 데이터
    - checksum
        - CRC-CCITT 생성 다항식 사용
    - control
        - 프레임 종류
            - information(I)
                - 맨 앞 비트 = 0
                - seq
                    - 송신용 순서번호
                - next
                    - 피기배킹을 이용한 응답
                    - 다음에 수신할 순서번호
                - P/F
                    - P=1
                        - 주국에서 종국에 데이터 전송 허용
                            - 수신단에서 반드시 주어진 시간내에 응답 보내야함
                            - 송신단에서 타임아웃 발생시 P=1로 응답요구
                    - F=1
                        - 종국에서 주국으로 데이터 전송
            - supervisory(S)
                - 맨 앞 비트 = 1
                - 응답 타입
                    - 0(RR, receive ready)
                        - 긍정응답
                    - 1(REJ, reject)
                        - 부정응답
                    - 2(RNR, receive not ready)
                        - 흐름제어
                        - 나중에 RR, REJ, 기타 프레임 전송하면 계속 진행
                    - 3(SRE, selective reject)
                        - 선택적 재전송
            - unnumbered(U)
                - 맨 앞 비트 = 11
                - 프레임 종류(type+modifier= 5비트)
                    - SABM
                        - **비동기 균형모드(ABM)** 연결설정 요구
                            - 두 호스트 모두 혼합국
                            - 양쪽에서 명령, 응답 전송
                    - SNRM
                        - **정규 응답모드(NRM)** 연결설정 요구
                            - 불균형모드
                            - 1:1 = 주국:종국
                            - 종국에서 데이터 전송 시 주국 허락 필요
                    - SARM
                        - **비동기 응답모드(ARM)** 연결설정 요구
                        - 불균형 모드
                        - 주국 허락없이 종국에서 데이터 전송 가능
                    - DISC
                        - 연결 해제 요구
                    - RSET
                        - 리셋 기능 수행
                        - N(R), N(S) 초기화(순서번호 초기화)
                    - FRMR
                        - 프레임 수신 거부
                    - UA
                        - 비번호 프레임에 대한 응답기능 수행
        - 필드
            - 송신용 순서번호
            - 다음에 받고자 하는 회신용 순서번호
            - 타입
                - SABM
                - UA
                - DM
                - FRMR...
            - P/F(poll/final)
- LAP(link access protocol)
    - ARM으로 동작
    - 연결설정
        - 주국에서 SARM 명령전송
        - 종국에서 SARM 응답전송
- LAPB(link access protocol balanced)
    - 양쪽 호스트가 혼합국
    - 임의의 호스트에서 SABM 전송



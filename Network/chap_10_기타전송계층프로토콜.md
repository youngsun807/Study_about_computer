# ---- UDP ----
- 비연결형 서비스 제공
- 헤더, 전송데이터에 대한 checksum 제공
- best effort 전달방식 지원
    - 전송데이터가 잘 도착했는지 확인X --> 신뢰성이 낮음
    - 데이터 처리 빠름 ---> 데이터 전송시간에 민감한 환경에서 유리
---
### UDP 헤더
- source port/ destination port
    - 송수신 프로세스에 할당된 네트워크 포트번호
- length
    - 헤더 포함 UDP 데이터그램 크기
    - max(65535byte = 2^16-1) --> 일반적으로 8192byte 이내 사용
- checksum
    - 헤더, 전송데이터에 대한 checksum
    - IP ---> 헤더에 대한 checksum수행
    - 옵션 --->0으로 처리하기도 함(checksum 계산X)
---
### 데이터전송
- 비연결형 서비스
    - 각 데이터그램이 독립적으로 전송, 중개
        - 도착 순서 바뀌어 도착할 수 있음
    - 흐름제어X --> 버퍼 오버플로우에 의한 데이터 분실가능
    - 응용에서 순서번호와 유사한 기능 구현해야함
---
---
# ---- RTP(real time protocol) ----
```
< 실시간 서비스>
- 멀티미디어 서비스환경 변화
- 실시간 스트리밍 서비스 등장
    - 데이터 변형, 분실 오류 복구하는 기능이 상대적으로 덜 중요
    - 도착 순서, 패킷 지연간의 데이터 압축 등이 필요
    - TCP
        - 패킷 순서, 신뢰성 강조
        - 패킷 재전송 기능, 복잡한 흐름제어 ---> 부적합
    - UDP
        - 단순 기능 ---> 빠른 전송 가능
        - 순서 보장X
    - 대안 ---> UDP + 순서번호 기능 = RTP
```
- 데이터 순서 정렬 ---> 타임스탬프 사용
- ALF(application level function) 사용 ---> 프로토콜 동작이 응용프로그램 라이브러리 형태로 구현 ---> 응용마다 별도 버퍼크기 조절, 관리 가능
- 실시간 응용 서비스에 유용
- 자원 예약, QoS 보장X ---> 실시간 동영상 서비스 제공 부족
- 요구사항
    - 정해진 시간 내에 도착 여부 중요
    - 신뢰성 덜 중요
- 버퍼 역할
    - 시간 간격이 가변적인 데이터 즉시 전송X ---> 지연 버퍼 사용하여 일정 간격 보정
        - 제한 시간 넘기면 폐기
    - 지연
        - 송신 프로세스에서 전송한 데이터 출발시간 - 수신 프로세스에 도착한 시간
        - 대역폭, 네트워크 구조, 라우팅방식, 전송 프로토콜 종류 등에 영향
- 지터
    - 데이터그램 도착지연시간 분포
        - 도착 시간 일정X, 불규칙적으로 도착하는 정도
---
### 데이터 전송프로토콜
- 동작원리
    - UDP 프로토콜 위에서 구현 ---> 작고 빠른 전송
    - 데이터그램 분실, 도착순서 변경등의 오류는 RTP에서 해결
    - 포트주소 이용 ---> 송수신 프로세스간 연결관리
    - 프로그램 하나가 아닌 일부기능이 개별적으로 구현
        - 응용 서비스 종류에 따라 요구 조건이 다른 기능들 추가
    - 다수 사용자가 하나의 세션을 사용하여 실시간 데이터 전송 가능
- 두 종류의 RTP 릴레이(relay) 지원
    - 릴레이
        - 데이터 전송과정에서 송수신 프로세스가 직접 데이터 전송할 수 없는 상황에서 데이터 중개
        - 방화벽 사용, 데이터 형식 상이
    - 믹서
        - 여러 송신 프로세스의 데이터그램을 적절히 조합 ---> 새로운 데이터 그램 생성
        - 믹싱 과정에서 데이터그램 스트림에 대한 시간정보 제공
    - 트랜슬레이터
        - 입력된 각 RTP 데이터그램을 하나 이상의 출력용 데이터그램으로 만듦(데이터 형식 변화 가능)
        - 예
            - 고해상도비디오 ---> 저해상도 변환
            - 멀티캐스트 RTP 데이터그램 복사 ---> 다수 유니캐스트 수신프로세스에게 전송
---
### RTP 헤더
- 응용환경과 관련된 가변 크기 헤더 추가 가능
- 처음 12바이트 = 모든 RTP 패킷에 존재
    - version(2비트)
    - padding
        - 패딩 바이트 존재여부 표시
    - extension
        - 고정헤더 뒤에 확장헤더가 이어지는지 여부
    - CSRC count
        - 4비트
        - CSRC 구분자 개수
    - marker
        - 1비트
        - 임의 표식위해 사용
        - 보통 데이터스트림의 경계점 표시
    - payload type(7비트)
    - sequence number
        - 분실, 순서번호 변경오류 검출
    - timestamp
        - 데이터그램의 생성시기
    - SSRC identifier
        - source 구분
        - 랜덤하게 생성된 32비트 숫자
    - CSRC identifier
        - 여러개 존재가능
        - 믹서에서 제공
- CSRC구분자 ---> 믹서에 의해 추가된 경우 사용
- 음성, 영상데이터의 동기에 필요한 시간정보, 데이터그램 분실, 도착순서 변경오류 검출
- 멀티캐스트 전송지원
    - 송신 구분자 필드有 ---> 그룹에서 누가 전송했는지 확인
- 각 미디어가 별도 RTP 세션 이용
    - 오디오, 비디오가 별도 세션으로 전송
    - RTP헤더에서 동기화 필요한 시간정보 제공
    - 페이로드 유형 지정 ---> 다양한 종류 데이터, 압축형식 지원
---
### RTP 제어 프로토콜(RTCP, RTP control protocol)
- 제어와 관련 기능 수행
- UDP를 하부계층으로 사용
- 세션 참가자는 다른 멤버에게 RTCP패킷을 주기적으로 전송
- 주요기능
    - QoS와 혼잡제어
        - 데이터 분배과정에서 발생하는 서비스 음질에 관한 피드백 기능지원
        - 멀티캐스팅 과정에서 송수신 진행여부 판단 위한 보고서 작성
            - 송신프로세스의 전송률
            - 수신 프로세스의 패킷분실
            - 지터...
    - identification
        - RTCP패킷 ⊃ RTCP 송신프로세스 관련정보
    - 세션크기
        - 세션 참가자 ∝ (1/RTP데이터 전송률)
        - max(RTCP 데이터그램 전송률) = 5초당 1데이터그램
    - 세션 제어
        - 최소한 세션 제어정보를 옵션으로 제공
- RTCP 데이터그램 종류
    - SR(sender report)
    - RR(receiver report)
    - SDES(source description)
        - 송신프로세스가 자세한 정보 제공
    - BYE(goodbye)
        - 송신 프로세스가 더이상 존재X
        - 수신 프로세스가 무한정 대기X
    - application defined packet
        - 응용 환경에 따른 기능점검
---
---
# ---- OSTI TP ----
- 서비스 클래스
    - 0 = 기본
    - 1 = 기본 오류 복구
    - 2 = 멀티플렉싱
    - 3 = 오류복구, 멀티플렉싱
    - 4 = 오류검출, 복구, 멀티플렉싱
- 클래스 0,1 = 단일포트 지원용도

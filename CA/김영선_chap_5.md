## **5.1 기억장치의 분류와 특성**
1. 기억장치 엑세스 
    - CPU가 어떤 정보를 기억장치에 쓰거나 읽는 동작
    1. 순차적
        > 처음부터 순서대로 저장, access 
        - (ex) 자기테이프
    2. 직접
        > 엑세스할 위치 근처로 직접 이동 ---> 순차적 검색 
        - (ex) 디스크, CD-ROM
    3. 랜덤
        > 주소에 의해 해당내용에 직접 접근
        - 어떤 기억장소든 엑세스 시간동일 
        - (ex) 반도체 기억장치
    4. 연관
        > 특정 비트들을 비교하여 일치하는 내용에 접근 
        - (ex) 연관 기억장치
2. 기억장치 설계
    - 고려해야할 특성들
        - 용량
        - 엑세스 속도
        - 가격
3. 전송단위
    > CPU가 한 번 엑세스 할 때 읽고 쓸 수 있는 비트 수
    - bps
        > 1초간에 송수신할 수 있는 비트수
    - 주기억장치
        > 단어단위, 하나의 주소에 저장된 단위
    - 보조저장장치
        > 블록 단위(512바이트/1킬로바이트...)
4. 주소지정 단위
    > 바이트/단어 단위
5. 엑세스 시간
    > 명령이 도달해서 데이터 엑세스 완료까지의 시간
6. 기억장치 사이클 시간 = 엑세스 시간 + 데이터 복원 시간
7. 데이터 전송률
    > 초당 엑세스 되는 비트수
8. 기억장치 유형
    - 제조 재료에 따라
        - 반도체 
        - 자기-표면 : 자화물질로 코팅된 표면에 정보 저장, 디스크
    - 저장 성질에 따라
        - 휘발성 : RAM
        - 비휘발성 : ROM, 디스크, CD-ROM
    - 삭제 불가능 
        - ROM
---
## **5.2 계층적 기억장치시스템**
1. 필요성
    ```
    속도, 용량, 가격 측면에서 다양함
    ```
2. 효과
    ```
    성능 대 가격비 향상
    ```
3. 구성방법
    - 첫번째 계층 기억장치
        - 속도 빠름
        - 가격 높음
    - 두번째 계층 기억장치
        - 속도 느림
        - 가격 낮음
4. 지역성의 원리
    - 한 번에 많이 엑세스 할 경우 특정영역을 기준으로 주변 영역을 첫번째 계층으로 엑세스 해놓으면 성능 향상
5. 기억장치 계층
    - 내부 기억장치
        - CPU가 직접 엑세스 가능
        - CPU 레지스터, 캐시, 주기억장치, 디스크 캐시
    - 외부 기억장치
        - CPU 직접 엑세스 불가
        - 장치 제어기를 통해서만 엑세스 가능
        - 디스크, CD-ROM
    - 캐시
        - 고비용, 고속
        ```
        CPU 속도가 빨라지면서 주기억장치 속도가 상대적으로 느림<br>
        ---> CPU와 주기억장치 사이에서 속도 차이를 극복하기 위해 사용
        ```
    - 디스크 캐시
        ```
        디스크와 주기억장치의 속도차이를 극복하기 위해 사용
        ```
        - 디스크 자체에 붙어있음
        - 주기억장치로부터 디스크로 읽힐 정보들 임시 저장하는 버퍼
---
5.3 반도체 기억장치
1. RAM(Random Access Memory)
    - read & write ---> 1개의 선으로 작동
    - 임의 엑세스
    - 휘발성
    - bit단위
    - 8*8비트 조직 = 주소 하나당 3개 비트 * 하나의 주소에 8비트 저장
    1. DRAM
        - 캐패시터(충전지)에 전하 충전
        - 집적 밀도 높음
        - 재충전 필요
        - 상대적 저비용 ---> 주기억장치
        - 한 주소 비트 수가 길어질수록 해독기 크기 커짐 ---> 주소비트를 반으로 쪼갬 ---> 행, 열로 찾아간다.
        - 행주소 공급 신호 = RAS(Row Address Strobe)
        - 열주소 공급 신호 = CAS(Column Address Strobe)
    2. SRAM
        - 플립플롭(flip-flop)
        - 집적 밀도 낮음
        - 재충전 없이 데이터 계속 유지 가능
        - DRAM보다 더 빠름
        - 캐시기억장치

2. ROM
    - 영구 저장 반도체 기억장치
    - read only
    - ex) 시스템 초기화 및 진단 프로그램(PC의 BIOS 프로그램)
    1. PROM
        - 한 번 쓰는 것 가능
    2. EPROM
        - 자외선으로 삭제 가능
        - 여러번 쓰기 가능
    3. EEPROM
        - 전기적으로 지울 수 있음
        - 수만번 갱신 가능
    4. 플래시 메모리
        - 블록 단위로 삭제
        - 페이지 단위로 읽기/쓰기 가능
        - EEPROM보다 삭제 시간 빠름
        - 집적 밀도 높음
---
## **5.4 기억장치 모듈의 설계**
1. 워드길이 확장
    - 기억장치 칩 데이터 비트수 < 단어길이 ---> 여려개의 칩들을 병렬로 접속한 기억장치 모듈로 구성
    - 모든 칩이 동시에 작동
2. 워드용량 확장
    - 기억장치 필요용량 > 각 기억장치 칩 용량 ---> 여려개 칩 직렬 접속 구성
    - 칩이 각각 작동
    - 하나의 회로에 하나의 데이터버스 사용
3. 워드길이 및 워드 용량 확장
    - 워드길이 확장 ---> 확장 된 것을 칩 1개라고 생각하고 용량 확장
4. RAM, ROM 차례로 연결
    - 분리되어있을 때는 분리, 이어져있을 때는 이어서 설계
5. 설계 순서
    - 컴퓨터 시스템에 필요한 기억장치 용량 결정
    - 사용할 칩 결정
    - 주소표 작성
    - 세부회로 설계
---   
## **5.5 캐시 기억장치**
> 목적 : CPU와 주기억장치 속도차이 최소화
1. 특징
    - 주기억장치보다 엑세스 속도 높은 칩 사용
    - 가격 및 제한공간 ----> 저용량
    - SRAM 사용
    - 캐시 메모리에 없으면 주기억장치에 저장
2. 용어
    - 캐시 적중(hit) <-> 캐시 미스(miss, 주기억장치에서 데이터 읽음)
        - 원하는 데이터가 캐시에 있는 상태
    - 적중률
        - 캐시 적중도
            > H = 캐시에 적중되는 횟수 / 전체 기억장치 엑세스 횟수
        - 프로그램과 데이터 지역성에 따라 달라짐
    - 캐시 미스율 = 1-H
    - 평균 기억장치 엑세스 시간
        > Ta = H*Tc + (1-H)*Tm
    - 블록 
        - 주기억장치로부터 동시에 인출되는 정보들의 그룹
        - 한번에 이동하는 정보들
    - 라인
        - 캐시에서 한 블록이 저장되는 장소
    - 태그
        - 라인에 적재된 블록을 구분해주는 정보
        > 캐시 라인크기 = 블록 크기
3. 지역성
    1. 시간적
        > 최근 엑세스된 프로그램이나 데이터가 가까운 미래에 다시 엑세스 될 가능성이 높음
    2. 공간적
        > 기억장치내에 인접하여 저장된 데이터들이 연속적으로 엑세스 될 가능성이 높음
    3. 순차적
        > 분기가 발생X ---> 기억장치 내 저장된 순서대로 명령어 인출, 실행
4. 캐시 설계 목표
    - 캐시 적중률 극대화
    - 캐시 엑세스 시간 최소화
    - 캐시 미스로 인한 지연시간 최소화
    - 주기억장치와 캐시간의 데이터 일관성 유지(주기억장치와 캐시 내의 데이터가 일치해야 함) ---> 오버헤드 최소화
5. 캐시 크기(용량)
    - 용량, 적중률 비례 ---> 비용 증가
    - 용량 확대 ---> 주소해독, 정보인출을 위한 주변회로 복잡성 증가 ---> 엑세스 시간 증가
6. 인출방식
    1. 요구 인출 
        - 필요한 정보만 인출
        - 캐시에 데이터 없을 경우 --> 주기억장치 검색 ---> 속도 저하 
    2. 선인출
        - 필요정보 + 앞으로 필요할 것으로 예측되는 정보도 미리 인출
        - 높은 지역성 ---> 효과 높음
        - 필요한 것 주변을 블럭 단위(일정 갯수만 <--- 용량 제한)로 이동 ---> 히트률 증가 ---> 속도 빠름
7. 사상방식
    > 어느 블록이 어디로 이동할 것인지 결정해주는 방법
    - 단어필드 맨뒤에 00이 생략된채로 계산, 실제로는 존재 ---> 1000(8) ---> 단어필드 : 10
    1. 직접 사상
        > 블록 : 캐시라인 = M:1로 적재 ---> 1개 시점 ---> 1개의 주기억장치 블록 ---> 1개의 캐시라인
        (해당라인의 다른 블록들은 캐시라인 사용X)
        - 히트률 저하 ---> 사용X
        - 주기억장치 주소형식
            - 태그필드 - 라인번호 - 단어필드
        - 장점
            - 하드웨어 간단 ---> 구현 비용 적음
        - 단점
            - 주기억장치 블록이 적재될 수 있는 캐시 라인 1개 ---> 그 라인 공유하는 다른 블록 적재되는 경우 SWAP-OUT
            - 적재 히트률 저하
    2. 완전 연관 사상
        > 블록이 캐시의 어떤 라인에도 적재 가능 ---> 라인 번호 X
        - 작은 크기 --> 구현 가능
        - 큰 크기 ---> 구현 어려움 ---> 사용X
        - 캐시 내의 모든 태그와 기억장치 내의 태그를 모두 비교해야 함 ---> 태그 라인 증가 ---> 복잡도 증가 ---> 어려움
        - 주소형식
            - 태그 - 단어
        - 장점 
            - 라인 선택 자유로움
            - 지역성 높다면 적중률 높음
        - 단점 
            - 태그 병렬 검사 ---> 고비용 연관기억장치 필요 ---> 복잡한 주변회로 필요
    3. 세트 연관사상
        > 블록이 1개의 캐시 세트 공유, 세트 내 2개 이상의 라인 적재 가능
        - 직접 사상 + 완전 연관 사상
        - 주소형식
            - 태그 - 세트 - 단어
            - 세트 단위로 세트 내 태그를 비교
8. 교체 알고리즘
    > 사용 이유 : 캐시 적중률 극대화
    - 세트 연관사상에서만 필요
    - 모든 라인들이 다른 블록들로 채워져 있으면 CPU가 필요한 데이터를 그들 중 하나와 교체
    1. 최소 최근 사용(LRU)
        - 오랫동안 사용되지 않은 블록 교체
    2. FIFO
        - 가장 오래전에 적재된 블록 교체
    3. 최소 사용 빈도(LFU)
        - 참조 횟수가 가장 적은 블록 교체
9. 쓰기 정채
    - 캐시 블록 변경 ---> 주기억장치 갱신시기, 방법 변경
    
    1. WRITE-THROUGH
        > 캐시, 주기억장치 동시 갱신
        - 장점 
            - 캐시 내용 = 주기억장치
        - 단점
            - 주기억장치 쓰기 포함하므로 쓰기 시간 길어짐
    2. WRITE-BACK
        > 캐시 변경, 주기억장치 갱신X ---> 캐시 상태 변경 시 갱신
        - 장점
            - 쓰기 동작 횟수 최소화
            - 쓰기 시간 절약
        - 단점
            - 캐시 내용과 주기억장치 내용이 다를 수 있음
            - 일관성 유지X
                - 데이터 불일치 문제
                > 주기억장치 블록내용 != 캐시 라인 복사본
10. 다중 캐시
    1. 계층적 캐시
        - 온칩 캐시
            - CPU 칩내에 포함시킨 캐시(L1)
            > 사용 이유 : 캐시 시간 단축
        - L2
            - CPU 밖 캐시
        - 속도 : L1>L2>MM
        - 크기(적중률) : L1<L2<MM
        - 포함관계 ; L1내용 ⊃ L2내용 ⊃ MM내용
    2. 분리 캐시
        - L1 분리 ---> I캐시(명령어캐시) + D캐시(데이터캐시) ---> 구조적 해저드 해결 ---> 충돌 막음
    - 듀얼코어 구조
        - 코어 내 L1캐시
        - L2 캐시는 코어들에 의해 공유
---
## **5.6 최신 기억장치 기술**
> 대규모 데이터 처리 ---> 주기억장치 병목 현상 심화 ---> 새로운 기억장치 개발
1. 휘발성 메모리 
    > 읽기 시간 : SDR < DDR <DDR2
    - 종류
        1. SRAM
            - 한주기에 한 데이터 읽음
            - 동기식 DRAM
            - 시스템 클록에 맞추어 엑세스 동작 수행
            - 다수의 뱅크들로 구성 ---> 뱅크별로 동시 엑세스
            - 읽기 동작 시, 행 전체가 감지 증폭기로 이동 ---> 행을 연다 --> 열 주소에 의해 바이트 단위로 데이터 버스에 실림
            - 버스트 모드
                - 여러 바이트들을 연속적으로 전송하는 동작
                - 효과 : 클록 당 한 바이트씩 연속 읽기 가능
            - 버스트 길이
                - 각 버스트 동작 동안 전송되는 데이터 바이트 수
            - CAS 지연 
                - CAS 신호와 열주소가 들어온 순간부터 데이터가 인출, 버스에 실릴 때까지 시간
            - 데이터 입출력 폭 = 8비트
            - 여러개 SDRAM 칩들을 병렬로 접속 
        2. DDR SDRAM
            > 버스 클록 당 두번의 데이터 전송(1주기에 2번 읽음)
            - 기억장치 대역폭 향상
            - DDR2 SDRAM
                - DDR SDRAM과 같음
                - 버스 클록 주파수만 두 배 높임
    - 기억장치 대역폭
        > 단위 시간당 데이터 전송량
        - 버스폭 * 클록 주파수
    - 기억장치 랭크
        > 데이터 입출력 폭이 64비트가 되도록 구성한 기억장치 모듈
        - 종류
            - 단면 모듈
            - 양면 모듈
2. 비휘발성
- 플래시 메모리보다 속도 높음
- DRAM보다 느림, 집적도 비슷, 저전력 소모
1. PRAM
    - 상태(전자)에 따라 에너지 보유가 달라짐
    - 전류 세기에 따라 내부구조 변화
    - 데이터 저장
        - 높은 전압 : 1 저장
        - 낮은 전압 : 0 저장
    - 데이터 읽기
        - 낮은 전압일 때
        - 낮은 저항 : 1
        - 높은 저항 : 0
    - 장점
        - 낮은 전압 범위에서 모든 전기적 동작 수행
        - 간단한 회로
        - 저전력 소모
2. FeRAM
    - 강유전체 사용
    - 전기가 없어도 극성 성질
    - 데이터 저장
        - 전기 흐름 : 1 저장
        - 전기 X : 0 저장 
    - 데이터 읽기
        - 전하 감지량에 따라 0,1 구분
    - 단점 
        - 읽기 동작 후 셀 내용 삭제 ---> 데이터 복구 필요
3. MRAM
    - 자기장을 이용하여 기억
    - 자기장이 제거되어도 자성 유지
    - 고정층 - 절연층 - 기록층
    - 데이터 저장
        - 기록층, 고정층 같은 방향 전류 흐름 : 0 저장
        - 기록층, 고정층 다른 방향 전류 흐름 : 1 저장
    - 데이터 읽기
        - 위아래층 같은 방향 전류 : 0
        - 위아래층 다른 방향 전류 : 1
                
  